/*url伪地址路由映射, (c) 2016 mawentao */

/* jappengine.js, (c) 2016 mawentao */

define("core/ajax",["require"],function(e){var t={},r={},n=[];return r.getAjaxUrl=function(e){return dz.ajaxapi+e},r.getJavaAjaxUrl=function(e){return dz.javaapi+e},r.abortAll=function(){console.log("abort_all_ajax_requests");for(var e=0;e<n.length;++e){var t=n[e];t.abort()}n=[]},r.ajaxrequest=function(e,t,r,i,o){var a;a=jQuery.ajax({url:t,type:e,dataType:"json",data:r,async:!o,complete:function(e){},success:function(e){i(e)},error:function(t,r,n){var i="Error("+t.readyState+") : "+r;"abort"==r?console.log("abort ajax: "+e):console.log(i)}}),n.push(a)},r.post=function(e,t,n,i){var o=r.getAjaxUrl(e);r.ajaxrequest("post",o,t,n,i)},r.postjava=function(e,t,n,i){var o=r.getJavaAjaxUrl(e);r.ajaxrequest("post",o,t,n,i)},r.postjava2=function(e,t,n,i){var o=r.getJavaAjaxUrl(e);r.ajaxrequest("post",o,t,n,i)},r.get=function(e,t,n,i){var o=r.getAjaxUrl(e);r.ajaxrequest("get",o,t,n,i)},r.getjava=function(e,t,n,i){var o=r.getJavaAjaxUrl(e);r.ajaxrequest("get",o,t,n,i)},r.loadcache=function(e,r,n){t[e]?r(t[e]):this.post(e,{},function(n){t[e]=n,r(n)},noanimation)},r.unsetcache=function(e){t[e]=null},r.clearcache=function(){t={}},r}),define("common/dict",["require"],function(e){function t(e){return r[e]?r[e]:(ajax.post("dict&action=getOptions",{key:e},function(t){if(0!=t.errno)alert(t.errmsg);else{r[e]=[];for(var n=0;n<t.data.length;++n)r[e].push(t.data[n])}},!0),r[e])}var r={active:[{text:"否",value:0},{text:"是",value:1}],fieldType:[{text:"文本",value:1},{text:"数字",value:2},{text:"图片",value:3},{text:"音频",value:4},{text:"视频",value:5}]},n={};return n.get_options=function(e,r){var n=t(e),i=[];r&&i.push(r);for(var o=0;o<n.length;++o)i.push(n[o]);return i},n.get_map=function(e){for(var r={},n=t(e),i=0;i<n.length;++i){var o=n[i];r[o.value]=o.text}return r},n}),define("er/util",[],function(){var now=+new Date,util={};util.guid=function(){return"er"+now++},util.mix=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r)for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e};var nativeBind=Function.prototype.bind;util.bind=nativeBind?function(e){return nativeBind.apply(e,[].slice.call(arguments,1))}:function(e,t){var r=[].slice.call(arguments,2);return function(){var n=r.concat([].slice.call(arguments));return e.apply(t,n)}},util.noop=function(){};var dontEnumBug=!{toString:1}.propertyIsEnumerable("toString");util.inherits=function(e,t){var r=function(){};r.prototype=t.prototype;var n=new r,i=e.prototype;e.prototype=n;for(var o in i)n[o]=i[o];return dontEnumBug&&(i.hasOwnProperty("toString")&&(n.toString=i.toString),i.hasOwnProperty("valueOf")&&(n.valueOf=i.valueOf)),e.prototype.constructor=e,e},util.parseJSON=function(text){return text?window.JSON&&"function"==typeof JSON.parse?JSON.parse(text):eval("("+text+")"):void 0};var whitespace=/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g;return util.trim=function(e){return e.replace(whitespace,"")},util.encodeHTML=function(e){return e+="",e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},util.getElement=function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},util}),define("er/Observable",["require","./util"],function(e){function t(){this._events={}}var r="_erObservableGUID";return t.prototype.on=function(t,n){this._events||(this._events={});var i=this._events[t];i||(i=this._events[t]=[]),n.hasOwnProperty(r)||(n[r]=e("./util").guid()),i.push(n)},t.prototype.un=function(e,t){if(this._events){if(!t)return void(this._events[e]=[]);var r=this._events[e];if(r)for(var n=0;n<r.length;n++)r[n]===t&&(r.splice(n,1),n--)}},t.prototype.fire=function(e,t){1===arguments.length&&"object"==typeof e&&(t=e,e=t.type);var n=this["on"+e];if("function"==typeof n&&n.call(this,t),this._events){null==t&&(t={}),"[object Object]"!==Object.prototype.toString.call(t)&&(t={data:t}),t.type=e,t.target=this;var i={},o=this._events[e];if(o){o=o.slice();for(var a=0;a<o.length;a++){var s=o[a];i.hasOwnProperty(s[r])||s.call(this,t)}}if("*"!==e){var u=this._events["*"];if(!u)return;u=u.slice();for(var a=0;a<u.length;a++){var s=u[a];i.hasOwnProperty(s[r])||s.call(this,t)}}}},t.enable=function(e){e._events={},e.on=t.prototype.on,e.un=t.prototype.un,e.fire=t.prototype.fire},t}),define("er/assert",[],function(){if(window.DEBUG){var e=function(e,t){if(!e)throw new Error(t)};return e.has=function(t,r){e(null!=t,r)},e.equals=function(t,r,n){e(t===r,n)},e.hasProperty=function(t,r,n){e(null!=t[r],n)},e.lessThan=function(t,r,n){e(r>t,n)},e.greaterThan=function(t,r,n){e(t>r,n)},e.lessThanOrEquals=function(t,r,n){e(r>=t,n)},e.greaterThanOrEquals=function(t,r,n){e(t>=r,n)},e}var e=function(){};return e.has=e,e.equals=e,e.hasProperty=e,e.lessThan=e,e.greaterThan=e,e.lessThanOrEquals=e,e.greaterThanOrEquals=e,e}),define("er/Deferred",["require","./util","./assert","./Observable"],function(e){function t(e){function t(){for(var t=0;t<r.length;t++){var n=r[t];n.apply(e.promise,e._args)}}if("pending"!==e.state){var r="resolved"===e.state?e._doneCallbacks.slice():e._failCallbacks.slice();e.syncModeEnabled?t():a(t),e._doneCallbacks=[],e._failCallbacks=[]}}function r(e,t,r,i){return function(){if("function"==typeof r){var o=t.resolver,a=r.apply(e.promise,arguments);n.isPromise(a)?a.then(o.resolve,o.reject):o.resolve(a)}else t[i].apply(t,e._args)}}function n(){this.state="pending",this._args=null,this._doneCallbacks=[],this._failCallbacks=[],this.promise={done:i.bind(this.done,this),fail:i.bind(this.fail,this),ensure:i.bind(this.ensure,this),then:i.bind(this.then,this)},this.promise.promise=this.promise,this.resolver={resolve:i.bind(this.resolve,this),reject:i.bind(this.reject,this)}}var i=e("./util"),o=e("./assert"),a="function"==typeof window.setImmediate?function(e){window.setImmediate(e)}:function(e){window.setTimeout(e,0)};return e("./Observable").enable(n),n.isPromise=function(e){return e&&"function"==typeof e.then},n.prototype.syncModeEnabled=!1,n.prototype.resolve=function(){"pending"===this.state&&(this.state="resolved",this._args=[].slice.call(arguments),n.fire("resolve",{deferred:this,args:this._args,reason:this._args[0]}),t(this))},n.prototype.reject=function(){"pending"===this.state&&(this.state="rejected",this._args=[].slice.call(arguments),n.fire("reject",{deferred:this,args:this._args,reason:this._args[0]}),t(this))},n.prototype.done=function(e){return this.then(e)},n.prototype.fail=function(e){return this.then(null,e)},n.prototype.ensure=function(e){return this.then(e,e)},n.prototype.then=function(e,i){var o=new n;return o.syncModeEnabled=this.syncModeEnabled,this._doneCallbacks.push(r(this,o,e,"resolve")),this._failCallbacks.push(r(this,o,i,"reject")),t(this),o.promise},n.all=function(){function e(e){a--,o.greaterThanOrEquals(a,0,"workingCount should be positive");var t=[].slice.call(arguments,1);t.length<=1&&(t=t[0]),u[e]=t,0===a&&l[s].apply(l,u)}function t(){s="reject",e.apply(this,arguments)}var r=[].concat.apply([],arguments),a=r.length;if(!a)return n.resolved();for(var s="resolve",u=[],l=new n,c=0;c<r.length;c++){var f=r[c];f.then(i.bind(e,f,c),i.bind(t,f,c))}return l.promise},n.resolved=function(){var e=new n;return e.resolve.apply(e,arguments),e.promise},n.rejected=function(){var e=new n;return e.reject.apply(e,arguments),e.promise},n.require=function(){var e=[].slice.call(arguments),t=new n;return window.require(e,t.resolver.resolve),t.promise.abort=t.resolver.reject,t.promise},n}),define("er/events",["require","./Observable"],function(e){var t={notifyError:function(e){return"string"==typeof e&&(e=new Error(e)),this.fire("error",{error:e}),e}};return e("./Observable").enable(t),t}),define("er/config",{mainElement:"main",indexURL:"/",systemName:"",noAuthorityLocation:"/401",notFoundLocation:"/404"}),define("er/locator",["require","./config","./events","./Observable"],function(e){function t(){var e=location.href.indexOf("#"),t=-1===e?"":location.href.slice(e);return t}function r(){var e=t();a.redirect(e)}function n(e){window.addEventListener?window.addEventListener("hashchange",r,!1):"onhashchange"in window&&document.documentMode>7?window.attachEvent("onhashchange",r):u=setInterval(r,100),e&&(l=setTimeout(r,0))}function i(){u&&(clearInterval(u),u=null),l&&(clearTimeout(l),l=null),window.removeEventListener?window.removeEventListener("hashchange",r,!1):"onhashchange"in window&&document.documentMode>7&&window.detachEvent("onhashchange",r)}function o(e,r){var o=s!==e;return o&&t()!==e&&(r.silent?(i(),location.hash=e,n(!1)):location.hash=e),s=e,o}var a={},s="",u=0,l=1;return a.start=function(){n(!0)},a.stop=i,a.resolveURL=function(t){return t+="",0===t.indexOf("#")&&(t=t.slice(1)),t&&"/"!==t||(t=e("./config").indexURL),t},a.redirect=function(t,r){r=r||{},t=a.resolveURL(t);var n=s,i=o(t,r);(i||r.force)&&(r.silent||a.fire("redirect",{url:t,referrer:n}),e("./events").fire("redirect",{url:t,referrer:n}))},a.reload=function(){s&&a.redirect(s,{force:!0})},e("./Observable").enable(a),a}),define("er/Action",["require","./util","./Observable","./Deferred","./events","./locator","./locator"],function(e){function t(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];r.success||e.push(r)}return this.handleError(e)}function r(){this.disposed=!1}var n=e("./util"),i=e("./Observable");return r.prototype.context=null,r.prototype.modelType=null,r.prototype.viewType=null,r.prototype.enter=function(r){this.context=r||{},this.fire("enter");var i=r&&r.url&&r.url.getQuery(),o=n.mix({},r,i);if(this.model=this.createModel(o),this.model&&"function"==typeof this.model.load){var a=this.model.load();return a.then(n.bind(this.forwardToView,this),n.bind(t,this))}return this.forwardToView(),e("./Deferred").resolved(this)},r.prototype.handleError=function(e){throw e},r.prototype.createModel=function(e){if(this.modelType){var t=new this.modelType(e);return t}return{}},r.prototype.forwardToView=function(){if(this.disposed)return this;if(this.fire("modelloaded"),this.view=this.createView(),this.view)this.view.model=this.model,this.view.container||(this.view.container=this.context.container),this.fire("beforerender"),this.view.render(),this.fire("rendered"),this.initBehavior(),this.fire("entercomplete");else{var t=e("./events");t.notifyError("No view attached to this action")}return this},r.prototype.createView=function(){return this.viewType?new this.viewType:null},r.prototype.initBehavior=function(){},r.prototype.leave=function(){this.disposed=!0,this.fire("beforeleave"),this.model&&("function"==typeof this.model.dispose&&this.model.dispose(),this.model=null),this.view&&("function"==typeof this.view.dispose&&this.view.dispose(),this.view=null),this.fire("leave")},r.prototype.redirect=function(t,r){var n=e("./locator");n.redirect(t,r)},r.prototype.reload=function(){var t=e("./locator");t.reload()},n.inherits(r,i),r}),define("core/eraction",["require","er/Action"],function(e){var t=e("er/Action"),r=new t;return r.on("enter",function(){var t=this.context.url,r=t.getPath(),n="view"+("/"==r?"/index":r),i=n+"/page";e([i],function(e){e.open(t.getQuery(),"ct")})}),r}),define("er/permission",[],function(){var e={},t={add:function(t){for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];"object"==typeof n?this.add(n):e[r]=n}},isAllow:function(t){return!!e[t]}};return t}),define("er/URL",["require","./util"],function(e){function t(e,n,i){e=e||"/",n=n||"",i=i||"~",this.toString=function(){return n?e+i+n:e},this.getPath=function(){return e},this.getSearch=function(){return n};var o=null;this.getQuery=function(e){return o||(o=t.parseQuery(n)),e?o[e]:r.mix({},o)}}var r=e("./util");return t.parse=function(e,n){var i={querySeparator:"~"};n=r.mix(i,n);var o=e.indexOf(n.querySeparator);return o>=0?new t(e.slice(0,o),e.slice(o+1),n.querySeparator):new t(e,"",n.querySeparator)},t.withQuery=function(e,n,i){e+="";var o={querySeparator:"~"};i=r.mix(o,i);var a=e.indexOf(i.querySeparator)<0?i.querySeparator:"&",s=t.serialize(n),u=e+a+s;return t.parse(u,i)},t.parseQuery=function(e){for(var t=e.split("&"),r={},n=0;n<t.length;n++){var i=t[n];if(i){var o=i.indexOf("="),a=0>o?decodeURIComponent(i):decodeURIComponent(i.slice(0,o)),s=0>o?!0:decodeURIComponent(i.slice(o+1));r.hasOwnProperty(a)?s!==!0&&(r[a]=[].concat(r[a],s)):r[a]=s}}return r},t.serialize=function(e){if(!e)return"";var t="";for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];t+="&"+encodeURIComponent(r)+"="+encodeURIComponent(n)}return t.slice(1)},t.empty=new t,t}),define("er/router",["require","./URL","./events","./locator"],function(e){function t(t){for(var i=e("./URL").parse(t.url),o=i.getPath(),a=0;a<r.length;a++){var s=r[a];if(s.rule instanceof RegExp&&s.rule.test(o)||s.rule===o)return void s.handler.call(null,i)}n&&n.call(null,i),e("./events").fire("route",{url:i})}var r=[],n=null,i={add:function(e,t){r.push({rule:e,handler:t})},setBackup:function(e){n=e},start:function(){e("./locator").on("redirect",t)}};return i}),define("er/controller",["require","./permission","./Observable","./locator","./Deferred","./URL","./config","./events","./util","./assert","./router","./assert","./URL"],function(e){function t(t){if(!t)return!0;"string"==typeof t&&(t=t.split("|"));for(var r=e("./permission"),n=0;n<t.length;n++)if(r.isAllow(t[n]))return!0;return!1}function r(e){var n=e.url.getPath(),i=f[n];if(i&&i.movedTo){m.fire("actionmoved",{url:e.url,config:i,movedTo:i.movedTo});var o=h.parse(i.movedTo);return e.originalURL=e.url,e.url=o,r(e)}if(i&&i.childActionOnly&&!e.isChildAction&&(i=null),!i)return m.fire("actionnotfound",y.mix({failType:"NotFound",reason:"Not found"},e)),e.originalURL=e.url,e.url=h.parse(g.notFoundLocation),f[e.url.getPath()]?r(e):null;var a=t(i.authority);if(!a){m.fire("permissiondenied",y.mix({failType:"PermissionDenied",reason:"Permission denied",config:i},e));var s=i.noAuthorityLocation||g.noAuthorityLocation;return e.originalURL=e.url,e.url=h.parse(s),r(e)}return i}function n(e){var t=r(e);if("function"==typeof b.resolveActionConfig&&(t=b.resolveActionConfig(t,e)),!t){var n=new p;return n.syncModeEnabled=!1,n.reject("no action configured for url "+e.url.getPath()),n.promise}if(e.title=t.title,t.args)for(var i in t.args)t.args.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t.args[i]);var o=new p;o.syncModeEnabled=!1;var a=o.promise,s=!1;return a.abort=function(){s||(s=!0,m.fire("actionabort",y.mix({},e)))},e.isChildAction||(d=e.url),window.require([t.type],function(r){if(!s){if(!r){var n="No action implement for "+acrtionConfig.type,i=y.mix({failType:"NoModule",config:t,reason:n},e);return m.fire("actionfail",i),m.notifyError(i),void o.reject(n)}if("function"==typeof r)return void o.resolve(new r,e);var a=r;if("function"==typeof a.createRuntimeAction&&(a=a.createRuntimeAction(e),!a)){var n="Action factory returns non-action",i=y.mix({failType:"InvalidFactory",config:t,reason:n,action:a},e);return m.fire("actionfail",i),m.notifyError(i),void o.reject(n)}m.fire("actionloaded",{url:e.url,config:t,action:r}),o.resolve(a,e)}}),a}function i(e,t){if(!t.isChildAction){if(t.url!==d)return;v&&(m.fire("leaveaction",{action:v,to:y.mix({},t)}),"function"==typeof v.leave&&v.leave()),v=e,document.title=t.title||t.documentTitle||g.systemName}m.fire("enteraction",y.mix({action:e},t));var r=e.enter(t);return r.then(function(){m.fire("enteractioncomplete",y.mix({action:e},t))},function(e){var r="";e?e.message?(r=e.message,e.stack&&(r+="\n"+e.stack)):r=window.JSON&&"function"==typeof JSON.stringify?JSON.stringify(e):e:r="Invoke action.enter() causes error";var n=y.mix({failType:"EnterFail",reason:r},t);m.fire("enteractionfail",n),m.notifyError(n)}),r}function o(e,t,r,i){var o={url:e,container:t,isChildAction:!!i};if(i){var a=x[t];o.referrer=a?a.url:null}else o.referrer=d;y.mix(o,r);var s=n(o);return w.has(s,"loadAction should always return a Promise"),s}function a(e){"string"==typeof e&&(e=h.parse(e)),c&&"function"==typeof c.abort&&c.abort(),c=o(e,g.mainElement,null,!1),c.then(i).fail(y.bind(m.notifyError,m))}function s(e,t){var r=x[e.id];r&&(x[e.id]=void 0,r.action&&(t||(t={url:null,referrer:r.url,container:e.id,isChildAction:!0}),m.fire("leaveaction",{action:r.action,to:t}),"function"==typeof r.action.leave&&r.action.leave()))}function u(t,r,n,i){s(t,i);var o={url:i.url,action:r,hijack:n};x[t.id]=o;var a=e("./Observable");r instanceof a&&r.on("leave",function(){s(t)})}function l(t,r){function n(t,n,i){n=n||{};var o=e("./locator"),t=o.resolveURL(t,n);if(n.global){var a=document.getElementById(r.container);return a&&s(a),void o.redirect(t,n)}var u=x[r.container],l=t.toString()!==u.url.toString();(l||n.force)&&(n.silent?u.url=t:b.renderChildAction(t,r.container,i))}function o(e){e=e||window.event;var t=e.target||e.srcElement;if("a"===t.nodeName.toLowerCase()){var r=t.getAttribute("href",2)||"";if("#"===r.charAt(0)){e.preventDefault?e.preventDefault():e.returnValue=!1;var i=r.substring(1),o="global"===t.getAttribute("data-redirect");n(i,{global:o})}}}j[r.container]=null;var a=document.getElementById(r.container);return a?(t.redirect=n,t.reload=function(e){this.redirect(r.url,{force:!0},e)},u(a,t,o,r),i(t,r)):void 0}var c,f={},d=null,v=null,p=e("./Deferred"),h=e("./URL"),g=e("./config"),m=e("./events"),y=e("./util"),w=e("./assert"),b={registerAction:function(e){w.hasProperty(e,"path",'action config should contains a "path" property'),f[e.path]=e},start:function(){g.systemName||(g.systemName=document.title),e("./router").setBackup(a)},resolveActionConfig:function(e){return e}},x={};b.renderAction=a;var j={};return b.renderChildAction=function(t,r,n){var i=e("./assert");i.has(r),"string"==typeof t&&(t=e("./URL").parse(t));var a=j[r];a&&"function"==typeof a.abort&&a.abort();var s=o(t,r,n,!0),u=s.then(l,y.bind(m.notifyError,m));return u.abort=s.abort,j[r]=u,u},b}),define("er/main",["require","./controller","./router","./locator"],function(e){var t={version:"3.0.3",start:function(){e("./controller").start(),e("./router").start(),e("./locator").start()}};return t}),define("er",["er/main"],function(e){return e}),define("core/urlmap",["require","core/eraction","er/main","er/controller"],function(e){e("core/eraction");var t={},r={};return r.start=function(){e("er/main").start(),this.addmap("/"),this.addmap("/index")},r.addmap=function(r){var n=r.lastIndexOf("~");n>=0&&(r=r.substr(0,n));var i=[];i.push(r);for(var o=0;o<i.length;++o){var a=i[o];if(!t[a]){var s={path:a,type:"core/eraction"};e("er/controller").registerAction(s),t[a]=!0;var u="view"+("/"==a?"/index":a);mwt.log_debug("map url path [#"+a+"] to javascript "+u+"/page.js#open")}}},r}),define("core/BasePage",["require"],function(e){var t=function(e){this.id="index",this.name="首页",this.domid="";var t="",r=!1,n=null;e&&(e.id&&(this.id=e.id),e.name&&(this.name=e.name),e.noPosNav&&(r=!0),e.posarr&&(n=e.posarr),e.passRoles&&(t=e.passRoles),this.domid="panel-"+this.id.replaceAll("/","-")),this.open=function(e,t){var r=(this.name,t);textblock.loading("loading...",r),this.execute(r,e)},this.execute=function(e,t){}};return t}),define("model/category",["require"],function(e){var t=null,r={};return r.syncLoad=function(e){return ajax.post("resource&action=getRootCategoryList",{},function(e){0!=e.retcode?mwt.alert(e.retmsg):t=e.data},!0),t},r.get=function(e){return t?t:r.syncLoad(e)},r}),define("view/index/list",["require"],function(e){function t(){var e=r.size();if(0==e)return void textblock.warning("暂无相关资源","body-"+i);for(var t=[],n=0;e>n;++n){var o=r.get(n),a='<a class="weui_cell" href="'+o.actionUrl+'"><div class="weui_cell_hd"><img src="'+o.icon+'" class="rscicon"></div><div class="weui_cell_bd weui_cell_primary" style="padding-right:6px;"><p>'+o.title+'</p></div><div class="weui_cell_ft"><button class="mwt-btn mwt-btn-success mwt-btn-sm radius">下载</button></div></a>';t.push(a)}var a='<div class="weui_cells" style="margin:15px 0;">'+t.join("")+"</div>";jQuery("#body-"+i).html(a)}var r,n,i,o={};return o.init=function(e){i=e;var o='<div id="body-'+i+'"></div><div id="pagebar-'+i+'" style="margin-bottom:20px;"></div>';jQuery("#"+i).html(o),r=new mwt.Store({proxy:new mwt.HttpProxy({beforeLoad:store_before_load,afterLoad:store_after_load,url:ajax.getAjaxUrl("resource&action=query")})}),n=new MWT.PageBar({store:r,render:"pagebar-"+i,pageSize:20,pageStyle:2}),r.on("load",t)},o.query=function(e){r.baseParams=e,n.changePage(1)},o}),define("view/index/toolbar",["require","model/category","./list"],function(e){function t(t){var r=e("model/category").get();(0==r.length||0!=r[0].id)&&r.unshift({id:0,name:"全部"});for(var n=[],i=0;i<r.length;++i){var o=r[i],a=o.id==t?' class="active"':"",s='<li><a name="mdown-cate-a" href="javascript:;" data-cid="'+o.id+'"'+a+">"+o.name+"</a></li>";n.push(s)}return'<ul class="mdown-cateul">'+n.join("")+"</ul>"}var r={},n={cateid:0,key:""};return r.init=function(i,o){n.cateid=o.cateid?o.cateid:0,n.key=o.key?o.key:"";var a='<table><tr><th>资源分类：</th></tr><tr><td style="padding-top:8px;">'+t(n.cateid)+'</td></tr><tr style="display:none;"><th style="padding-top:14px;">资源搜索：</th><td style="padding-top:14px;"><div class="mwt-search"><input id="mdown-sokey" type="text" class="mwt-field" style="width:100px;height:30px;" placeholder="查询关键词" value="'+n.key+'"><i id="mdown-sokeybtn" class="icon icon-search" style="vertical-align:middle;"></i></div></td></tr></table>';jQuery("#"+i).html(a),e("./list").query(n),jQuery("#mdown-sokey").unbind("change").change(r.go),jQuery("#mdown-sokeybtn").unbind("click").click(r.go),jQuery("[name=mdown-cate-a]").unbind("click").click(function(){n.cateid=jQuery(this).data("cid"),r.go()})},r.go=function(){n.key=mwt.get_value("mdown-sokey");var e="plugin.php?id=mdown:index#/~cateid="+n.cateid+"&key="+n.key;window.location=e},r}),define("view/index/page",["require","core/BasePage","model/category","./list","./toolbar"],function(e){var t=e("core/BasePage"),r=(e("model/category"),new t({noPosNav:!0,name:"首页",id:"index"}));return r.execute=function(t,r){var n='<table class="mdown-tablay"><tr><td style="padding:0 10px;"><div class="mdown-panel" style="background:#f4f5f6;padding:5px;"><div class="mdown-body" id="mdown-tbar"></div></div><div id="mdown-sores" style="min-height:200px;padding-bottom:0;">loading...</div></td></table>';jQuery("#"+t).html(n),e("./list").init("mdown-sores"),e("./toolbar").init("mdown-tbar",r)},r});var ajax,dict,posnav;define("jappengine",["require","core/ajax","common/dict","core/urlmap","view/index/page"],function(e){ajax=e("core/ajax"),dict=e("common/dict");var t=e("core/urlmap"),r=[e("view/index/page")],n={};return n.start=function(){t.start();for(var e=0;e<r.length;++e){var n=r[e];t.addmap("/"+n.id)}},n});