define(["require"],function(e){function t(){new mwt.BorderLayout({render:"frame-side",items:[{id:"frame-logo",region:"north",height:50,html:'<a class="logoa" href="#/"><label><img src="'+dz.pluginpath+'/template/static/ankix-logo.png">Anki X</label></a>'},{id:"frame-nav",region:"center",style:"padding-top:8px;"}]}).init(),n()}function n(){var e=[];if(nav&&nav.length)for(var t=1==setting.fold_navmenu?"menu-close":"menu-open",n=0;n<nav.length;++n){var i=nav[n],a=i.subitems&&i.subitems.length>0,r=a?"javascript:;":i.href,l=a?' class="'+t+'"':"",s=i.icon?i.icon:"fa fa-th-large",o="navitem-"+i.text,c=1==i.newtab?' target="_blank"':"",u="<li"+l+'><a name="navitem" class="lm-menu" href="'+r+'" id="'+o+'"'+c+'><i class="'+s+'"></i><br>'+lan(i.text)+"</a>";if(a){u+="<ul class='submenu'>";for(var m=0;m<i.subitems.length;++m){var d=i.subitems[m],r=d.href,o="navitem-"+d.text,s=d.icon?d.icon:"fa fa-caret-right";u+="<li><a name='navitem' class='lm-item' href='"+r+"' id='"+o+"'><i class=\""+s+'"></i>&nbsp;'+lan(d.text)+"</a></li>"}u+="</ul>"}u+="</li>",e.push(u)}e.push('<li class="clearfix"></li>');var u='<ul class="leftmenu">'+e.join("")+"</ul>";jQuery("#frame-nav").html(u),jQuery(".lm-menu").unbind("click").click(function(){var e=jQuery(this).parent().children(".submenu");if(e){var t=e.css("display");t&&("none"==t?(jQuery(this).parent().removeClass("menu-close"),jQuery(this).parent().addClass("menu-open")):(jQuery(this).parent().removeClass("menu-open"),jQuery(this).parent().addClass("menu-close")))}})}function i(){var e=[{text:"English",value:"en"},{text:"简体中文",value:"zh"}];new mwt.ToolBar({render:"frame-header",items:[{label:'<i class="icon icon-bar"></i>',cls:"mwt-btn-icon",handler:s.collapseSide},{label:'<i class="sicon-home"></i>',cls:"mwt-btn-icon",handler:function(){window.location="#/"}},{label:'<a href="'+dz.siteurl+'" target="_blank" class="mwt-btn-icon"><i class="sicon-compass"></i></a>',cls:"mwt-btn-icon"},"->",{type:"select",id:"langsel",label:"",width:50,value:language,cls:"langsel",options:e,handler:function(){var e=mwt.get_select_value("langsel");setlang(e)}},'<button id="ucpopbtn" class="mwt-btn mwt-btn-icon" style="width:auto;padding:0 10px 0 5px;"><i class="sicon-user" style="font-size:13px !important;"></i> '+dz.username+"</button>"]}).create(),jQuery("#ucpopbtn").hover(function(){mwt.showFloatDiv("ucpop",-10,28)},function(){jQuery("#ucpop").hide()}),jQuery("#ucpop").hover(function(){jQuery(this).show()},function(){jQuery(this).hide()})}var a="frame-body",r=56,l=!1,s={};return s.init=function(){l||(1==dz.embedded?new mwt.FillLayout({render:"frame",id:a,style:"",html:""}).init():(new mwt.BorderLayout({render:"frame",items:[{id:"frame-side",region:"west",width:r},{id:"frame-center",region:"center"}]}).init(),new mwt.BorderLayout({render:"frame-center",items:[{id:"frame-header",region:"north",height:35},{id:a,region:"center"}]}).init(),t(),i()),l=!0)},s.clear=function(){ajax.abortAll();var e='<div class="global-loading"><i class="icon icon-loading fa fa-spin fa-2x"></i></div>';jQuery("#"+a).html(e)},s.getContainer=function(){return s.clear(),a},s.collapseSide=function(){var e=jQuery("#frame-side"),t=jQuery("#frame-center"),n=e.width(),i=0>=n?r:0,a=e.hasClass("mwt-layout-border-east")?"right":"left";"left"==a?(e.css({width:i+"px"}),t.css({left:i+"px"})):(e.css({width:i+"px"}),t.css({right:i+"px"}))},s.getCopyright=function(e){e||(e="#aaa");var t=dz.siteurl+"/plugin.php?id=datacube",n=s.getLogo();return'<a href="'+t+'" style="display:block;padding:20px 0 10px;text-align:center;color:'+e+';font-size:13px;text-decoration:none;"><img src="'+n+'" style="width:16px;height:16px;vertical-align:text-bottom"> </a>'},s});