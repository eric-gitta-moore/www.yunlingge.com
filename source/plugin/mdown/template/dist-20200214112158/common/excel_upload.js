define(["require"],function(e){function t(){var e='<form method="POST" enctype="multipart/form-data"><input type="file" id="excelfile" name="excelfile" accept="*.xls,*.xlsx" style="display:none;"/></form>';jQuery("#"+c).html(e),l=jQuery("#excelfile"),l.unbind("change").change(i)}function i(){var e=l.val();if(""!=e){var i=ajax.getAjaxUrl("excel&action=upload&fileElementId=excelfile");jQuery.ajaxFileUpload({url:i,secureuri:!1,fileElementId:"excelfile",dataType:"json",timeout:3e4,complete:function(e){t()},success:function(e,t){0!=e.retcode?mwt.alert(e.retmsg):n&&n(e.data)},error:function(e,t,i){alert("Error: "+i)}})}}var n,l,a={},c="image-upload-div";return a.init=function(){if(!document.getElementById(c)){var e=document.createElement("div");e.id=c,document.body.appendChild(e)}t()},a.upload=function(e){l||a.init(),n=e,l.val(""),l.click()},a});