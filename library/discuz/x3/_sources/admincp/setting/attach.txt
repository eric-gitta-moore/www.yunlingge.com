..

上传设置
================

为使站点内容更加丰富，站点中往往允许用户自行上传附件至服务器中，上传设置中包括附件上传到本地的基本设置、开启远程附件设置、还包括了论坛附件、空间附件和门户附件的上传设置，下面一一进行详细讲解。

一、基本设置

图1

1)本地附件保存位置

默认为 ./data/attachment 服务器路径, 属性 777, 必须为 web 可访问到的目录, 结尾不加 "/", 相对目录务必以 "./" 开头。

2)本地附件 URL 地址

默认为 data/attachment 可为当前 URL 下的相对地址或 http:// 开头的绝对地址, 结尾不加 "/", 不能把这个设为远程附件URL地址。

3)图片处理库类型

分为 GD 和 ImageMagick

GD 是最广泛的处理库但是使用的系统资源较多。

选择 ImageMagick 需要填写ImageMagick 6 程序的安装路径，如果服务器的操作系统为 Windows，路径不要使用长文件名。

ImageMagick 速度快系统资源占用少，但需要服务器有执行命令行命令的权限。如果你的服务器有条件安装此程序，请到 http://www.imagemagick.org 下载，安装后在这里填写安装的路径。

4)缩略图质量

设置图片附件缩略图的质量参数，范围为 0～100 的整数，数值越大结果图片效果越好，但尺寸也越大。

5)预览

点击“预览缩略图效果”可以查看缩略图预览效果

图2

二、远程附件

详细请参考：如何设置远程附件http://www.discuz.net/thread-2775531-1-1.html

三、论坛附件

与论坛有关的附件设置。

图3

1)帖子中显示图片附件

选择“是”在帖子中直接将图片或动画附件显示出来，而不需要点击附件链接。

图4

如果选择“否”指帖子中不直接显示图片，而需要点击附件链接才可以看到，如下图：

图5

2)附件 URL 地址、媒体附件播放

开启附件 URL 地址后，上传附件的地址可通过 "attach://aid" 方式在任何帖内引用，并支持媒体类附件的直接播放。

此项设置需要在 用户组=>帖子相关 中允许用户组使用多媒体代码方可生效。

图6

a、上传普通附件如图片、压缩格式的附件在帖内引用

发表一个带有附件的帖子。

图7

点击上图中的附件链接，插入帖子中，效果为：

图8

在帖子中引用该附件链接地址

图9

点击编辑框上方的插入链接图标，“请输入链接的地址”处输入该附件的地址，如：attach://40.zip，“请输入链接的文字”处输入该附件链接的文字说明，如：tools工具下载，然后提交。

图10

图11

点击帖子中的附件链接“tools工具下载”即可打开附件下载到本地。

说明：这里的附件地址“attach://40.zip”可以在任何帖子内引用。

b、传媒体类附件如 mp3 格式的音乐，可在帖内直接播放。

发表一个带有 mp3 格式音乐附件的帖子。

图12

点击上图中的多媒体图标，插入帖子中，效果为：

图13

提交后，便可在帖子中直接播放音乐。

图14

3)论坛帖子附件缩略图设置

设置为用户在帖子上传的 JPG/PNG/GIF 图片附件添加缩略图或将图片附件缩到指定的大小。不支持动画 GIF 格式，用户可选择不启用缩略图，和小于指定大小、保持比率或与指定大小相同、保持比率，超出部分剪切的缩略方式。

4)是否直接缩放原图

选择“是”，将直接缩放原图，而不生成缩略图文件。

缩略图大小：设置缩略图的大小，小于此尺寸的图片附件将不生成缩略图。

5)附件链接有效期

单位：小时，0 或留空表示附件链接永久有效，过期后链接自动更新。本功能可有效防止附件被盗链或附件被软件批量下载，但是会给会员的正常下载带来不便

6)下载附件来路检查

选择“是”将检查下载附件的来路，来自其他网站或站点的下载请求将被禁止。注意: 本功能在开启“帖子中显示图片附件”时，会加重服务器负担。

四、空间附件

指定空间附件图片的最大尺寸

图15

如果用户上传一些尺寸很大的数码图片，则程序会按照本设置进行缩小该图片并显示，比如可以设置为 宽：1024px，高：768px，但都不能小于 300px。设置为 0，则不做任何处理。

本功能需要PHP环境支持GD才生效。

五、门户附件

可以设置门户的文章图片缩略图以及文章图片的缩略图尺寸，如下图所示：

图16

如果开启了文章图片缩略图，可以设置缩略图的尺寸，如果上传一些尺寸很大的数码图片，则程序会按照本设置进行生成相应的小图片，默认大小为 300*300。

本功能需要PHP环境支持GD才生效。




