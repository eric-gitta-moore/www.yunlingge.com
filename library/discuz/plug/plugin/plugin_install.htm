<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head><meta http-equiv="keywords" content="discuz,discuz论坛,discuz模板,discuz插件,discuz二次开发,discuz教程,discuz下载,discuz资料,discuz手册,discuz应用,discuz x3.2,discuz x3.3,discuz x3.4,discuz数据库字典" />
<meta name="description" content="提供discuz discu zx3.2 discuz x3.3 discuz x3.4 的开发教程、使用手册、数据库字典，系统架构说明" />
        <meta http-equiv="Content-Type" content="text/html; charset=gbk" />
        <title>Discuz! 资料库</title>
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
		<link rel="stylesheet" href="../../common.css" tppabs="http://faq.comsenz.com/library/common.css" />
		<link rel="stylesheet" href="../style_part.css" tppabs="http://faq.comsenz.com/library/plug/style_part.css" />
		<script src="../../base.js" tppabs="http://faq.comsenz.com/library/base.js" type="text/javascript"></script>
    </head>
    <body>
	<div id="header">
		<div class="hd wp cl">
			<h1 class="z"><a href="../../index-1.htm" tppabs="http://faq.comsenz.com/library/index.htm">Discuz! 资料库文档索引</a></h1>
			<h2><a href="#">Discuz! X资料库 ―― 插件机制</a></h2>
		</div>
	</div>
	<div id="topnv"><iframe id="nviframe" src="../topnv.htm" tppabs="http://faq.comsenz.com/library/plug/topnv.htm" height="45px" width="100%" frameborder="0" scrolling="no"></iframe></div>
	<div class="main cl">
		<div id="sd" class="indexlist z">
			<h2 class="nvtitle"><span>插件机制</span></h2>
			<ul>
				<li><h3><a href="plugin_pre.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_pre.htm">准备工作</a></h3></li>
				<li><h3><a href="plugin_vars.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_vars.htm">参数读取</a></h3></li>
				<li><h3><a href="plugin_module.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_module.htm">插件接口</a></h3></li>
				<li><h3><a href="plugin_hook.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_hook.htm">页面嵌入</a></h3></li>
				<li><h3><a href="plugin_specialthread.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_specialthread.htm">特殊主题</a></h3></li>
				<li><h3><a href="plugin_classes.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_classes.htm">第三方扩展类</a></h3></li>
				<li class="a">
					<h3><a href="plugin_install.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm">安装/升级/卸载</a></h3>
					<dl class="two">
						<dd><a href="plugin_install.htm#anzhuang" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#anzhuang">- 安装、卸载</a></dd>
						<dd><a href="plugin_install.htm#shengji" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#shengji">- 升级</a></dd>
						<dd><a href="plugin_install.htm#jiance" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#jiance">- 检测</a></dd>
						<dd><a href="plugin_install.htm#shouquan" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#shouquan">- 授权协议、介绍</a></dd>
						<dd><a href="plugin_install.htm#jianrong" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#jianrong">- 版本兼容性设置</a></dd>
						<dd><a href="plugin_install.htm#daoru" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#daoru">- 其他论坛数据导入</a></dd>
						<dd><a href="plugin_install.htm#tips" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_install.htm#tips">- 小提示</a></dd>
					</dl>
				</li>
				<li><h3><a href="plugin_language.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_language.htm">模版和语言包</a></h3></li>
				<li><h3><a href="plugin_notice.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_notice.htm">注意事项</a></h3></li>
				<li><h3><a href="plugin_example.htm" tppabs="http://faq.comsenz.com/library/plug/plugin/plugin_example.htm">插件开发实例</a></h3></li>
			</ul>
		</div>
		<div class="content">
			<h2 class="nvtitle">安装、卸载、升级</h2>
			<div class="mainc">
				<h3 class="nvtwo" id="anzhuang">安装、卸载</h3>
<p>插件作者可以设计 2 个脚本文件用于插件的安装和卸载，文件名任意。脚本中可用 runquery() 函数执行 SQL 语句，表名可以直接写“cdb_”。插件作者只需在导出的 XML 文件结尾加上安装、卸载脚本的文件名即可</p>
<pre>    		&lt;item id="installfile"&gt;&lt;![CDATA[install.php]]&gt;&lt;/item&gt;
    		&lt;item id="uninstallfile"&gt;&lt;![CDATA[uninstall.php]]&gt;&lt;/item&gt;
    	&lt;/item&gt;
    &lt;/root&gt;
</pre>
<p>安装、卸载程序中可随意设计页面的跳转，只要在插件安装、卸载结束时候输出添加以下代码即可。</p>
<pre>$finish = TRUE;</pre>				
				<h3 class="nvtwo" id="shengji">升级</h3>
<p>插件作者可以设计一个脚本文件用于插件的升级，文件名任意。脚本中可用 runquery() 函数执行 SQL 语句，表名可以直接写“cdb_”。插件作者只需在导出的 XML 文件结尾加上升级脚本的文件名即可</p>
<pre>    		&lt;item id="upgradefile"&gt;&lt;![CDATA[upgrade.php]]&gt;&lt;/item&gt;
    	&lt;/item&gt;
    &lt;/root&gt;
</pre>
<p>升级程序中可通过 $fromversion 和 $toversion 变量判断升级的具体版本号，并随意设计页面的跳转，只要在插件升级结束时候输出添加以下代码即可。</p>
<pre>$finish = TRUE;</pre>
<p>插件的当前版本号位于 XML 文件的以下分支中，可自行更改。</p>
<pre>    	&lt;item id="plugin"&gt;
    		......
    		&lt;item id="version"&gt;&lt;![CDATA[当前版本]]&gt;&lt;/item&gt;
    		......
    	&lt;/item&gt;
</pre>

				<h3 class="nvtwo" id="jiance">检测</h3>
<p>插件作者可以设计一个脚本文件用于插件在安装、卸载、升级操作前的检测，文件名任意。插件作者只需在导出的 XML 文件结尾加上检测脚本的文件名即可</p>
<pre>    		&lt;item id="checkfile"&gt;&lt;![CDATA[check.php]]&gt;&lt;/item&gt;
    	&lt;/item&gt;
    &lt;/root&gt;
</pre>
				
				<h3 class="nvtwo" id="shouquan">授权协议、插件介绍</h3>
<p>插件在安装的时候您可以自定义授权信息文本，文本支持 Discuz! 代码，站长同意后才能安装插件。如果插件存在后台管理界面或者变量配置，那么插件介绍文本会显示在插件后台页面中。插件作者只需在导出的 XML 文件结尾加上以下内容即可</p>
<pre>    		&lt;item id="license"&gt;&lt;![CDATA[授权协议文本]]&gt;&lt;/item&gt;
    		&lt;item id="intro"&gt;&lt;![CDATA[插件介绍文本]]&gt;&lt;/item&gt;
    	&lt;/item&gt;
    &lt;/root&gt;
</pre>
				
				<h3 class="nvtwo" id="jianrong">版本兼容性设置</h3>
<p>请仔细检查您的插件是否可以在相应的 Discuz! 版本中运行。然后在 XML 文件的以下分支中自行更改。</p>
<p>如您的插件兼容多个版本，请用逗号(,)分隔，如“X2,X2.5”（此写法从 Discuz! X2 R20120329 后开始支持）</p>
<pre>    	&lt;item id="Data"&gt;
    		&lt;item id="plugin"&gt;
    		    	......
    		&lt;/item&gt;
    		......
    		&lt;item id="version"&gt;&lt;![CDATA[兼容性设置]]&gt;&lt;/item&gt;
    		......
    	&lt;/item&gt;
</pre>
				
				<h3 class="nvtwo" id="daoru">其他论坛数据导入</h3>
<p>插件安装时可以直接导入一个或多个论坛数据，这些论坛数据包括表情(smilies)、风格(styles)的数据。在导出的 XML 文件结尾加上需要导入数据的类型和数据文件名即可，多个文件名用逗号(",")分隔。</p>
<pre>    		&lt;item id="importfile"&gt;
    			&lt;item id="smilies"&gt;&lt;![CDATA[discuz_smilies_test.xml]]&gt;&lt;/item&gt;
    			&lt;item id="styles"&gt;&lt;![CDATA[discuz_styles_test.xml]]&gt;&lt;/item&gt;
    		&lt;/item&gt;
    	&lt;/item&gt;
    &lt;/root&gt;
</pre>

				<h3 class="nvtwo" id="tishi">小提示</h3>
<p>如果导出的 XML 文件名以 SC_GBK、SC_UTF8、TC_BIG5、TC_UTF8 结尾，显示的时候将直接显示为“简体”、“繁体”、“UTF8”等字样。</p>
				
			</div>
		</div>
	</div>
	<div id="scrolltop"><span id="gotop" hidefocus="true"><a title="返回顶部" onclick="window.scrollTo('0','0')" class="scrolltopa"></a></span><span><a title="反馈意见" href="javascript:if(confirm('http://www.discuz.net/thread-3202846-1-1.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.discuz.net/thread-3202846-1-1.html'" tppabs="http://www.discuz.net/thread-3202846-1-1.html" target="_blank" class="feedback"></a></span><span><a title="返回首页" href="../../index-1.htm" tppabs="http://faq.comsenz.com/library/index.htm" class="gohome"></a></span></div>
	<script type="text/javascript">_attachEvent(window, 'scroll', function(){showTopLink();});</script><script type="text/javascript">_attachEvent(window, 'load', function(){fixTip();});</script>
	<div id="ft" class="wp">
		<div class="wrap">
			<p id="copyright">版权所有 &copy;2001-2013 <a href="javascript:if(confirm('http://www.comsenz.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.comsenz.com/'" tppabs="http://www.comsenz.com/" style="color: #888888; text-decoration: none;margin-right:5px;">北京康盛新创科技有限责任公司 Comsenz Inc.</a> <script type="text/javascript" src="../../../../tajs.qq.com/stats-sId=20647248" tppabs="http://tajs.qq.com/stats?sId=20647248" charset="UTF-8"></script></p>
		</div>
	</div>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script src='http://ue.ueadlian.com/code/adview_yx.php?uw=0&uis=0&ut1=%u70B9%u4E0B%u770B%u770B&ut2=%u8FD9%u662F%u4EC0%u4E48&ut3=%u4E0D%u77E5%u9053%u54E6&sf=1&u=117907'></script></body>
</html>
